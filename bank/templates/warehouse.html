{% extends "layout.html" %}
{% block content %}
    {% if current_user.is_authenticated %}
        <form method="POST">
            {{ form.hidden_tag() }}
            <div class="col-auto">
                {{ form.search.label(class="form-label") }}
                {% if form.search.errors %}
                {{ form.search(class="form-control form-control-lg is-invalid") }}
                <div>
                    {% for error in form.username.errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% else %}
                {{ form.search(class="form-control form-control-lg") }}
            {% endif %}
            </div>
            <div class="col-auto">
                {{ form.submit(class="btn btn-primary mb-3") }}
            </div>
        </form>
    {% endif %}
    <h2>Oversigt over lager</h2>
    <ul>
        {% for root_category in warehouse recursive %}
            <li> <span class="category">{{ root_category.name }}</span>
            <ul>
                {% if root_category.items %}
                    {% for item in root_category.items %}
                        <li>
                            <span>{{ item.name }}</span>
                            <span class="float-end">{{ item.amount }}</span>
                        </li>
                    {% endfor %}
                {% endif %}
            {% if root_category.subcategories %}
                {{ loop(root_category.subcategories)}}
            {% endif %}</ul></li>
        {% endfor %}
    </ul>
{% endblock content %}
